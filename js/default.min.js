/*WikiPangako*/
!function(){function i(i,t){$.post("modules/ajax/ajax.php",{action:"addWatchlist",id:i,account_id:t},function(){$("#"+i).html('Added to Watchlist <i class="icon-eye-open"></i>'),$("#"+i).attr("disabled","disabled"),$("#"+i+"-container").fadeOut(3e3),$("#"+i).remove(),$("#"+i+"-container").appendTo(".my-watchlist").fadeIn(3e3)})}function t(i,t){$.post("modules/ajax/ajax.php",{action:"addWatchlist",id:i,account_id:t},function(){$("#"+i).html('Added to Watchlist <i class="icon-eye-open"></i>'),$("#"+i).attr("disabled","disabled"),$("#"+i).fadeOut(3e3)})}function e(i,t){$.post("modules/ajax/ajax.php",{action:"addContact",account_id1:i,account_id2:t},function(){$("#"+i).html('Added to Network <i class="icon-plus-sign"></i>'),$("#"+i).attr("disabled","disabled"),$("#"+i+"-container").fadeOut(3e3),$("#"+i).remove(),$("#"+i+"-container").appendTo(".my-watchlist").fadeIn(3e3)})}function a(i,t){$.post("modules/ajax/ajax.php",{action:"addContact",account_id1:i,account_id2:t},function(){$("#"+i).html('Added to Network <i class="icon-plus-sign"></i>'),$("#"+i).attr("disabled","disabled"),$("#"+i).fadeOut(3e3)})}function s(i,t,e){$.post("modules/ajax/ajax.php",{action:"ratePolitician",rating:i,account_id:t,politician_id:e},function(i){data=jQuery.parseJSON(i),rate=data.like[0].like-data.hate[0].hate,$("#politician-rating").text(rate)})}function o(i){$.post("modules/ajax/ajax.php",{action:"deleteWikip",wikip_id:i},function(){var t=parseInt($("#wikip-count").text());t--,$("#"+i).fadeOut(3e3),$("#wikip-count").text(t)})}function n(i){$.post("modules/ajax/ajax.php",{action:"deletePromise",promise_id:i},function(){$("#"+i).fadeOut(3e3)})}function r(i,t,e,a){e+"-finished"==a&&($("#"+a).hasClass("btn-inverse")?$("#"+a).attr("class","btn btn-success finished active"):($("#"+a).attr("class","btn btn-inverse finished"),i=0),$("#"+e+"-inprogress").hasClass("btn-info")&&$("#"+e+"-inprogress").attr("class","btn btn-inverse inprogress"),$("#"+e+"-failed").hasClass("btn-danger")&&$("#"+e+"-failed").attr("class","btn btn-inverse failed")),e+"-inprogress"==a&&($("#"+a).hasClass("btn-inverse")?$("#"+a).attr("class","btn btn-info inprogress active"):($("#"+a).attr("class","btn btn-inverse inprogress"),i=0),$("#"+e+"-finished").hasClass("btn-success")&&$("#"+e+"-finished").attr("class","btn btn-inverse finished"),$("#"+e+"-failed").hasClass("btn-danger")&&$("#"+e+"-failed").attr("class","btn btn-inverse failed")),e+"-failed"==a&&($("#"+a).hasClass("btn-inverse")?$("#"+a).attr("class","btn btn-danger failed active"):($("#"+a).attr("class","btn btn-inverse failed"),i=0),$("#"+e+"-finished").hasClass("btn-success")&&$("#"+e+"-finished").attr("class","btn btn-inverse finished"),$("#"+e+"-inprogress").hasClass("btn-info")&&$("#"+e+"-inprogress").attr("class","btn btn-inverse inprogress")),$.post("modules/ajax/ajax.php",{action:"ratePromise",status:i,account_id:t,promise_id:e},function(i){data=jQuery.parseJSON(i),$("#"+e+"-finished .finished-count").text(data.done[0].done),$("#"+e+"-inprogress .inprogress-count").text(data.inprogress[0].inprogress),$("#"+e+"-stalled .stalled-count").text(data.stalled[0].stalled),$("#"+e+"-failed .failed-count").text(data.failed[0].failed)})}function c(i){$.post("modules/ajax/ajax.php",{action:"isSeen",account_id:i})}function d(){var i=$("#timestamp").val();$("#loading-gif").show(),$.post("modules/ajax/ajax.php",{action:"retrieveWikipsLazy",last_timestamp:i},function(i){$(".newsfeed").append(i)}),$("#loading-gif").hide()}function l(i,t,e,a){window.open(i,"WikiPangako","status = 1, height = 450, width = 600, resizable = 0"),$.post("modules/ajax/ajax.php",{action:"incrementStatsCount",id:t,stats:e,type:a})}function p(){FB.ui({method:"apprequests",message:"Invite your friends to jon WikiPangako!"})}$(document).ready(function(){window.fbAsyncInit=function(){FB.init({appId:"516429741767185",status:!0,xfbml:!0})},$("#guest-login").click(function(){var i=$("#username").val(),t=$("#password").val();$.post("modules/ajax/ajax.php",{action:"login",username:i,password:t},function(i){"true"!=i?($(".alert-error").fadeIn(1e3),$(".alert-error").fadeOut(4e3)):$(".alert-error").fadeOut(1e3)})});var h=500,u="...",m="<br><br>See more",f="<br><br>See less";$(".more").each(function(){var i=$(this).html();if(i.length>h){var t=i.substr(0,h),e=i.substr(h-1,i.length-h),a=t+'<span class="moreellipses">'+u+'&nbsp;</span><span class="morecontent"><span>'+e+'</span>&nbsp;&nbsp;<a href="javascript: void(0);" class="morelink">'+m+"</a></span>";$(this).html(a)}});var g=20;$(".know-first").each(function(){var i=$(this).html();if(i.length>g){var t=i.substr(0,g),e=(i.substr(g-1,i.length-g),t+'<span class="moreellipses">'+u+"&nbsp;</span>");$(this).html(e)}});var w=17;$(".details").each(function(){var i=$(this).html();if(i.length>w){var t=i.substr(0,w),e=(i.substr(w-1,i.length-w),t+'<span class="moreellipses">'+u+"&nbsp;</span>");$(this).html(e)}}),$(".morelink").click(function(){return $(this).hasClass("less")?($(this).removeClass("less"),$(this).html(m)):($(this).addClass("less"),$(this).html(f)),$(this).parent().prev().toggle(),$(this).prev().toggle(),!1}),$("#message").mousemove(function(i){var t=$(this).offset();t.bottom=$(this).offset().top+$(this).outerHeight(),t.right=$(this).offset().left+$(this).outerWidth(),$(this).css(t.bottom>i.pageY&&i.pageY>t.bottom-16&&t.right>i.pageX&&i.pageX>t.right-16?{cursor:"nw-resize"}:{cursor:""})}).keyup(function(i){for((8==i.which||46==i.which)&&$(this).height(parseFloat(0!=parseFloat($(this).css("min-height"))?$(this).css("min-height"):$(this).css("font-size")));$(this).outerHeight()<this.scrollHeight+parseFloat($(this).css("borderTopWidth"))+parseFloat($(this).css("borderBottomWidth"));)$(this).height($(this).height()+1)}),$("#promise").mousemove(function(i){var t=$(this).offset();t.bottom=$(this).offset().top+$(this).outerHeight(),t.right=$(this).offset().left+$(this).outerWidth(),$(this).css(t.bottom>i.pageY&&i.pageY>t.bottom-16&&t.right>i.pageX&&i.pageX>t.right-16?{cursor:"nw-resize"}:{cursor:""})}).keyup(function(i){for((8==i.which||46==i.which)&&$(this).height(parseFloat(0!=parseFloat($(this).css("min-height"))?$(this).css("min-height"):$(this).css("font-size")));$(this).outerHeight()<this.scrollHeight+parseFloat($(this).css("borderTopWidth"))+parseFloat($(this).css("borderBottomWidth"));)$(this).height($(this).height()+1)}),$("#promise-sources").mousemove(function(i){var t=$(this).offset();t.bottom=$(this).offset().top+$(this).outerHeight(),t.right=$(this).offset().left+$(this).outerWidth(),$(this).css(t.bottom>i.pageY&&i.pageY>t.bottom-16&&t.right>i.pageX&&i.pageX>t.right-16?{cursor:"nw-resize"}:{cursor:""})}).keyup(function(i){for(/^(http|https|ftp):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i.test($("#promise-sources").val())?$("#submit-promise").removeAttr("disabled"):$("#submit-promise").attr("disabled","disabled"),(8==i.which||46==i.which)&&$(this).height(parseFloat(0!=parseFloat($(this).css("min-height"))?$(this).css("min-height"):$(this).css("font-size")));$(this).outerHeight()<this.scrollHeight+parseFloat($(this).css("borderTopWidth"))+parseFloat($(this).css("borderBottomWidth"));)$(this).height($(this).height()+1)}),$(".fileupload").fileupload(),$("#navbar").affix(),$('[data-spy="affix"]').each(function(){$(this).affix("refresh")}),$(".hate").click(function(){var i=$("#account-id").val(),t=$("#politician-id").val();$(".hate").hasClass("btn-inverse")?($(".hate").attr("class","btn btn-danger rate hate active"),s(0,i,t),$("#vote-stat").attr("class","vote-down"),$("#vote-stat").text("You voted down."),$("#vote-stat").fadeIn(),$("#vote-stat").delay(2500).fadeOut()):($(".hate").attr("class","btn btn-inverse rate hate"),s(-1,i,t),$("#vote-stat").attr("class","vote-back"),$("#vote-stat").text("Vote Removed."),$("#vote-stat").fadeIn(),$("#vote-stat").delay(2500).fadeOut()),$(".like").hasClass("btn-success")&&$(".like").attr("class","btn btn-inverse rate like")}),$(".like").click(function(){var i=$("#account-id").val(),t=$("#politician-id").val();$(".like").hasClass("btn-inverse")?($(".like").attr("class","btn btn-success rate like active"),like_flag=1,s(1,i,t),$("#vote-stat").attr("class","vote-up"),$("#vote-stat").text("You voted up."),$("#vote-stat").fadeIn(),$("#vote-stat").delay(2500).fadeOut()):($(".like").attr("class","btn btn-inverse rate like"),s(-1,i,t),$("#vote-stat").attr("class","vote-back"),$("#vote-stat").text("Vote Removed."),$("#vote-stat").fadeIn(),$("#vote-stat").delay(2500).fadeOut()),$(".hate").hasClass("btn-danger")&&$(".hate").attr("class","btn btn-inverse rate hate")}),$(".head").each(function(){var i=$(this).closest("li").find(".content");$(this).click(function(t){t.preventDefault(),i.not(":animated").slideToggle()})}),$(".ask").click(function(){return""==$("#ask-politician").val()?!1:!0}),$(".wikip").click(function(){return""==$("#wikip-politician").val()?!1:!0}),$("#drop3").click(function(){$(".notif-count-request").hide()}),$("#drop4").click(function(){$(".notif-count").hide(),account_id=$("#account_id").val(),c(account_id)}),$(".share-wikip").click(function(){wikip_id=$(this).attr("id"),url=$("#"+wikip_id+"-url").val(),caption=encodeURIComponent($("#"+wikip_id+"-caption").val()),wikip_id=wikip_id.replace("-share-wikip",""),l("https://www.facebook.com/sharer/sharer.php?s=100&p[url]=http%3A%2F%2Fwikipangako.com%2F%3Fread_only%3Dtrue%26wikip_id%3D"+wikip_id+"&p[images][0]="+url+"&p[title]=WikiPangako&p[summary]="+caption,wikip_id,"share","wikip")}),$(".share-promise").click(function(){promise_id=$(this).attr("id"),name=encodeURIComponent($("#"+promise_id+"-name").val()),politician_id=$("#"+promise_id+"-politician").val(),politician_name=encodeURIComponent($("#"+promise_id+"-politician-name").val()),details=encodeURIComponent($("#"+promise_id+"-details").val()),promise_id=promise_id.replace("-share-promise",""),l("https://www.facebook.com/sharer/sharer.php?s=100&p[url]=http%3A%2F%2Fwww.wikipangako.com%2F%3Fread_only%3Dtrue%26promise_id%3D"+promise_id+"&p[images][0]=http://www.wikipangako.com/img/politicians/"+politician_id+".jpg&p[title]="+name+"%20by%20"+politician_name+"&p[summary]="+details,promise_id,"share","promise")}),$(".tweet-wikip").click(function(){wikip_id=$(this).attr("id"),caption=encodeURIComponent($("#"+$(this).attr("id")+"-caption").val()),wikip_id=wikip_id.replace("-tweet-wikip",""),l("https://twitter.com/intent/tweet?text=%20%23wikipangako%20%23"+caption+"&url=http%3A%2F%2Fwikipangako.com%2F%3Fread_only%3Dtrue%26wikip_id%3D"+wikip_id+"&related=sharethis&via=wikipangako",wikip_id,"tweet","wikip")}),$(".tweet-promise").click(function(){promise_id=$(this).attr("id"),details=encodeURIComponent($("#"+$(this).attr("id")+"-details").val()),promise_id=promise_id.replace("-tweet-promise",""),l("https://twitter.com/intent/tweet?text=%20%23pangakowatch%20%23"+details+"&url=http%3A%2F%2Fwww.wikipangako.com%2F%3Fmain%3Dhome%26inner%3Dpromise_url%26promise_id%3D"+promise_id+"&related=sharethis&via=wikipangako",promise_id,"tweet","promise")}),$(".finished").click(function(){original_id=$(this).attr("id"),account_id=$("#account_id").val(),promise_id=original_id.replace("-finished",""),r(1,account_id,promise_id,original_id)}),$(".inprogress").click(function(){original_id=$(this).attr("id"),account_id=$("#account_id").val(),promise_id=original_id.replace("-inprogress",""),r(2,account_id,promise_id,original_id)}),$(".failed").click(function(){original_id=$(this).attr("id"),account_id=$("#account_id").val(),promise_id=original_id.replace("-failed",""),r(4,account_id,promise_id,original_id)}),$(".add-watchlist").click(function(){politician_id=$(this).attr("id"),account_id=$("#account_id").val(),i(politician_id,account_id)}),$(".add-watchlist-profile").click(function(){politician_id=$(this).attr("id"),account_id=$("#account_id").val(),t(politician_id,account_id)}),$(".add-network-profile").click(function(){profile_id=$(this).attr("id"),account_id=$("#account_id").val(),a(profile_id,account_id)}),$(".add-network").click(function(){profile_id=$(this).attr("id"),account_id=$("#account_id").val(),e(profile_id,account_id)}),$(".delete-wikip").click(function(){wikip_id=$(this).attr("id"),wikip_id=wikip_id.replace("-delete",""),o(wikip_id)}),$(".delete-promise").click(function(){promise_id=$(this).attr("id"),promise_id=promise_id.replace("-delete",""),n(promise_id)}),$(".share-profile").click(function(){politician_id=$("#politician_id").val(),name=$(".share-profile-name").val(),l("https://www.facebook.com/sharer/sharer.php?s=100&p[url]=http%3A%2F%2Fwww.wikipangako.com%2F%3Fmain%3Dhome%26inner%3Dpolitician-profile%26id%3D"+politician_id+"&p[images][0]=http%3A%2F%2Fwww.wikipangako.com%2Fimg%2Fpoliticians%2F"+politician_id+".jpg&p[title]="+name+"&p[summary]=Politician%20Profile",politician_id,"share","politician")}),$(".tweet-profile").click(function(){politician_id=$("#politician_id").val(),name=$(".tweet-profile-name").val(),l("https://twitter.com/intent/tweet?text=%20%23pangakowatch%20%23"+name+"&url=http%3A%2F%2Fwww.wikipangako.com%2F%3Fmain%3Dhome%26inner%3Dpolitician-profile%26id%3D"+politician_id+"&related=sharethis&via=wikipangako",politician_id,"tweet","politician")}),$("#invite-friends").click(function(){p()}),$("#start-tour").click(function(){$("#siteTour .modal-body").html('<div id="this-carousel-id" class="carousel slide" data-ride="carousel"><div class="carousel-inner"><div class="item active"><img src="../img/tour/welcome.png" width="100%"/></div><div class="item"><img src="../img/tour/cando.png" width="100%"/></div><div class="item"><img src="../img/tour/monitor.png" width="100%"/></div><div class="item"><img src="../img/tour/upload.png" width="100%"/></div><div class="item"><img src="../img/tour/rate.png" width="100%"/></div><div class="item"><img src="../img/tour/getstarted.png" width="100%"/></div></div><a class="carousel-control left" href="#this-carousel-id" data-slide="prev">&lsaquo;</a><a class="carousel-control right" href="#this-carousel-id" data-slide="next">&rsaquo;</a></div>')}),("http://www.wikipangako.com/?main=home"==document.URL||"http://www.wikipangako.com/?main=home&sort=wikips"==document.URL)&&$(window).scroll(function(){$(window).scrollTop()+$(window).height()==$(document).height()&&d()})})}();